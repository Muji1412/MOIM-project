import{c as y,r as B,j as C,a as yr}from"./client.chunk.js";import{r as O}from"./inherits_browser.chunk.js";var Z={exports:{}},F={},et;function br(){return et||(et=1,y.crypto&&y.crypto.getRandomValues?F.randomBytes=function(s){var e=new Uint8Array(s);return y.crypto.getRandomValues(e),e}:F.randomBytes=function(s){for(var e=new Array(s),r=0;r<s;r++)e[r]=Math.floor(Math.random()*256);return e}),F}var K,tt;function M(){if(tt)return K;tt=1;var s=br(),e="abcdefghijklmnopqrstuvwxyz012345";return K={string:function(r){for(var t=e.length,n=s.randomBytes(r),i=[],o=0;o<r;o++)i.push(e.substr(n[o]%t,1));return i.join("")},number:function(r){return Math.floor(Math.random()*r)},numberString:function(r){var t=(""+(r-1)).length,n=new Array(t+1).join("0");return(n+this.number(r)).slice(-t)}},K}var rt;function U(){return rt||(rt=1,function(s){var e=M(),r={},t=!1,n=y.chrome&&y.chrome.app&&y.chrome.app.runtime;s.exports={attachEvent:function(o,a){typeof y.addEventListener<"u"?y.addEventListener(o,a,!1):y.document&&y.attachEvent&&(y.document.attachEvent("on"+o,a),y.attachEvent("on"+o,a))},detachEvent:function(o,a){typeof y.addEventListener<"u"?y.removeEventListener(o,a,!1):y.document&&y.detachEvent&&(y.document.detachEvent("on"+o,a),y.detachEvent("on"+o,a))},unloadAdd:function(o){if(n)return null;var a=e.string(8);return r[a]=o,t&&setTimeout(this.triggerUnloadCallbacks,0),a},unloadDel:function(o){o in r&&delete r[o]},triggerUnloadCallbacks:function(){for(var o in r)r[o](),delete r[o]}};var i=function(){t||(t=!0,s.exports.triggerUnloadCallbacks())};n||s.exports.attachEvent("unload",i)}(Z)),Z.exports}var Y,nt;function wr(){return nt||(nt=1,Y=function(e,r){if(r=r.split(":")[0],e=+e,!e)return!1;switch(r){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}),Y}var G={},it;function Er(){if(it)return G;it=1;var s=Object.prototype.hasOwnProperty,e;function r(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}function t(o){try{return encodeURIComponent(o)}catch{return null}}function n(o){for(var a=/([^=?#&]+)=?([^&]*)/g,l={},h;h=a.exec(o);){var u=r(h[1]),d=r(h[2]);u===null||d===null||u in l||(l[u]=d)}return l}function i(o,a){a=a||"";var l=[],h,u;typeof a!="string"&&(a="?");for(u in o)if(s.call(o,u)){if(h=o[u],!h&&(h===null||h===e||isNaN(h))&&(h=""),u=t(u),h=t(h),u===null||h===null)continue;l.push(u+"="+h)}return l.length?a+l.join("&"):""}return G.stringify=i,G.parse=n,G}var ee,ot;function ar(){if(ot)return ee;ot=1;var s=wr(),e=Er(),r=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,t=/[\n\r\t]/g,n=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/:\d+$/,o=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,a=/^[a-zA-Z]:/;function l(p){return(p||"").toString().replace(r,"")}var h=[["#","hash"],["?","query"],function(b,c){return m(c.protocol)?b.replace(/\\/g,"/"):b},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],u={hash:1,query:1};function d(p){var b;typeof window<"u"?b=window:typeof y<"u"?b=y:typeof self<"u"?b=self:b={};var c=b.location||{};p=p||c;var v={},x=typeof p,g;if(p.protocol==="blob:")v=new R(unescape(p.pathname),{});else if(x==="string"){v=new R(p,{});for(g in u)delete v[g]}else if(x==="object"){for(g in p)g in u||(v[g]=p[g]);v.slashes===void 0&&(v.slashes=n.test(p.href))}return v}function m(p){return p==="file:"||p==="ftp:"||p==="http:"||p==="https:"||p==="ws:"||p==="wss:"}function _(p,b){p=l(p),p=p.replace(t,""),b=b||{};var c=o.exec(p),v=c[1]?c[1].toLowerCase():"",x=!!c[2],g=!!c[3],f=0,w;return x?g?(w=c[2]+c[3]+c[4],f=c[2].length+c[3].length):(w=c[2]+c[4],f=c[2].length):g?(w=c[3]+c[4],f=c[3].length):w=c[4],v==="file:"?f>=2&&(w=w.slice(2)):m(v)?w=c[4]:v?x&&(w=w.slice(2)):f>=2&&m(b.protocol)&&(w=c[4]),{protocol:v,slashes:x||m(v),slashesCount:f,rest:w}}function I(p,b){if(p==="")return b;for(var c=(b||"/").split("/").slice(0,-1).concat(p.split("/")),v=c.length,x=c[v-1],g=!1,f=0;v--;)c[v]==="."?c.splice(v,1):c[v]===".."?(c.splice(v,1),f++):f&&(v===0&&(g=!0),c.splice(v,1),f--);return g&&c.unshift(""),(x==="."||x==="..")&&c.push(""),c.join("/")}function R(p,b,c){if(p=l(p),p=p.replace(t,""),!(this instanceof R))return new R(p,b,c);var v,x,g,f,w,S,T=h.slice(),A=typeof b,E=this,L=0;for(A!=="object"&&A!=="string"&&(c=b,b=null),c&&typeof c!="function"&&(c=e.parse),b=d(b),x=_(p||"",b),v=!x.protocol&&!x.slashes,E.slashes=x.slashes||v&&b.slashes,E.protocol=x.protocol||b.protocol||"",p=x.rest,(x.protocol==="file:"&&(x.slashesCount!==2||a.test(p))||!x.slashes&&(x.protocol||x.slashesCount<2||!m(E.protocol)))&&(T[3]=[/(.*)/,"pathname"]);L<T.length;L++){if(f=T[L],typeof f=="function"){p=f(p,E);continue}g=f[0],S=f[1],g!==g?E[S]=p:typeof g=="string"?(w=g==="@"?p.lastIndexOf(g):p.indexOf(g),~w&&(typeof f[2]=="number"?(E[S]=p.slice(0,w),p=p.slice(w+f[2])):(E[S]=p.slice(w),p=p.slice(0,w)))):(w=g.exec(p))&&(E[S]=w[1],p=p.slice(0,w.index)),E[S]=E[S]||v&&f[3]&&b[S]||"",f[4]&&(E[S]=E[S].toLowerCase())}c&&(E.query=c(E.query)),v&&b.slashes&&E.pathname.charAt(0)!=="/"&&(E.pathname!==""||b.pathname!=="")&&(E.pathname=I(E.pathname,b.pathname)),E.pathname.charAt(0)!=="/"&&m(E.protocol)&&(E.pathname="/"+E.pathname),s(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(w=E.auth.indexOf(":"),~w?(E.username=E.auth.slice(0,w),E.username=encodeURIComponent(decodeURIComponent(E.username)),E.password=E.auth.slice(w+1),E.password=encodeURIComponent(decodeURIComponent(E.password))):E.username=encodeURIComponent(decodeURIComponent(E.auth)),E.auth=E.password?E.username+":"+E.password:E.username),E.origin=E.protocol!=="file:"&&m(E.protocol)&&E.host?E.protocol+"//"+E.host:"null",E.href=E.toString()}function q(p,b,c){var v=this;switch(p){case"query":typeof b=="string"&&b.length&&(b=(c||e.parse)(b)),v[p]=b;break;case"port":v[p]=b,s(b,v.protocol)?b&&(v.host=v.hostname+":"+b):(v.host=v.hostname,v[p]="");break;case"hostname":v[p]=b,v.port&&(b+=":"+v.port),v.host=b;break;case"host":v[p]=b,i.test(b)?(b=b.split(":"),v.port=b.pop(),v.hostname=b.join(":")):(v.hostname=b,v.port="");break;case"protocol":v.protocol=b.toLowerCase(),v.slashes=!c;break;case"pathname":case"hash":if(b){var x=p==="pathname"?"/":"#";v[p]=b.charAt(0)!==x?x+b:b}else v[p]=b;break;case"username":case"password":v[p]=encodeURIComponent(b);break;case"auth":var g=b.indexOf(":");~g?(v.username=b.slice(0,g),v.username=encodeURIComponent(decodeURIComponent(v.username)),v.password=b.slice(g+1),v.password=encodeURIComponent(decodeURIComponent(v.password))):v.username=encodeURIComponent(decodeURIComponent(b))}for(var f=0;f<h.length;f++){var w=h[f];w[4]&&(v[w[1]]=v[w[1]].toLowerCase())}return v.auth=v.password?v.username+":"+v.password:v.username,v.origin=v.protocol!=="file:"&&m(v.protocol)&&v.host?v.protocol+"//"+v.host:"null",v.href=v.toString(),v}function j(p){(!p||typeof p!="function")&&(p=e.stringify);var b,c=this,v=c.host,x=c.protocol;x&&x.charAt(x.length-1)!==":"&&(x+=":");var g=x+(c.protocol&&c.slashes||m(c.protocol)?"//":"");return c.username?(g+=c.username,c.password&&(g+=":"+c.password),g+="@"):c.password?(g+=":"+c.password,g+="@"):c.protocol!=="file:"&&m(c.protocol)&&!v&&c.pathname!=="/"&&(g+="@"),(v[v.length-1]===":"||i.test(c.hostname)&&!c.port)&&(v+=":"),g+=v+c.pathname,b=typeof c.query=="object"?p(c.query):c.query,b&&(g+=b.charAt(0)!=="?"?"?"+b:b),c.hash&&(g+=c.hash),g}return R.prototype={set:q,toString:j},R.extractProtocol=_,R.location=d,R.trimLeft=l,R.qs=e,ee=R,ee}var te,st;function k(){if(st)return te;st=1;var s=ar();return te={getOrigin:function(e){if(!e)return null;var r=new s(e);if(r.protocol==="file:")return null;var t=r.port;return t||(t=r.protocol==="https:"?"443":"80"),r.protocol+"//"+r.hostname+":"+t},isOriginEqual:function(e,r){var t=this.getOrigin(e)===this.getOrigin(r);return t},isSchemeEqual:function(e,r){return e.split(":")[0]===r.split(":")[0]},addPath:function(e,r){var t=e.split("?");return t[0]+r+(t[1]?"?"+t[1]:"")},addQuery:function(e,r){return e+(e.indexOf("?")===-1?"?"+r:"&"+r)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}},te}var re={},ne,at;function ur(){if(at)return ne;at=1;function s(){this._listeners={}}return s.prototype.addEventListener=function(e,r){e in this._listeners||(this._listeners[e]=[]);var t=this._listeners[e];t.indexOf(r)===-1&&(t=t.concat([r])),this._listeners[e]=t},s.prototype.removeEventListener=function(e,r){var t=this._listeners[e];if(t){var n=t.indexOf(r);if(n!==-1){t.length>1?this._listeners[e]=t.slice(0,n).concat(t.slice(n+1)):delete this._listeners[e];return}}},s.prototype.dispatchEvent=function(){var e=arguments[0],r=e.type,t=arguments.length===1?[e]:Array.apply(null,arguments);if(this["on"+r]&&this["on"+r].apply(this,t),r in this._listeners)for(var n=this._listeners[r],i=0;i<n.length;i++)n[i].apply(this,t)},ne=s,ne}var ut;function P(){if(ut)return re;ut=1;var s=O(),e=ur();function r(){e.call(this)}return s(r,e),r.prototype.removeAllListeners=function(t){t?delete this._listeners[t]:this._listeners={}},r.prototype.once=function(t,n){var i=this,o=!1;function a(){i.removeListener(t,a),o||(o=!0,n.apply(this,arguments))}this.on(t,a)},r.prototype.emit=function(){var t=arguments[0],n=this._listeners[t];if(n){for(var i=arguments.length,o=new Array(i-1),a=1;a<i;a++)o[a-1]=arguments[a];for(var l=0;l<n.length;l++)n[l].apply(this,o)}},r.prototype.on=r.prototype.addListener=e.prototype.addEventListener,r.prototype.removeListener=e.prototype.removeEventListener,re.EventEmitter=r,re}var Q={exports:{}},ct;function xr(){if(ct)return Q.exports;ct=1;var s=y.WebSocket||y.MozWebSocket;return s?Q.exports=function(r){return new s(r)}:Q.exports=void 0,Q.exports}var ie,lt;function _r(){if(lt)return ie;lt=1;var s=U(),e=k(),r=O(),t=P().EventEmitter,n=xr(),i=function(){};function o(a,l,h){if(!o.enabled())throw new Error("Transport created when disabled");t.call(this);var u=this,d=e.addPath(a,"/websocket");d.slice(0,5)==="https"?d="wss"+d.slice(5):d="ws"+d.slice(4),this.url=d,this.ws=new n(this.url,[],h),this.ws.onmessage=function(m){i("message event",m.data),u.emit("message",m.data)},this.unloadRef=s.unloadAdd(function(){u.ws.close()}),this.ws.onclose=function(m){i("close event",m.code,m.reason),u.emit("close",m.code,m.reason),u._cleanup()},this.ws.onerror=function(m){u.emit("close",1006,"WebSocket connection broken"),u._cleanup()}}return r(o,t),o.prototype.send=function(a){var l="["+a+"]";this.ws.send(l)},o.prototype.close=function(){var a=this.ws;this._cleanup(),a&&a.close()},o.prototype._cleanup=function(){var a=this.ws;a&&(a.onmessage=a.onclose=a.onerror=null),s.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},o.enabled=function(){return!!n},o.transportName="websocket",o.roundTrips=2,ie=o,ie}var oe,ft;function Sr(){if(ft)return oe;ft=1;var s=O(),e=P().EventEmitter,r=function(){};function t(n,i){e.call(this),this.sendBuffer=[],this.sender=i,this.url=n}return s(t,e),t.prototype.send=function(n){this.sendBuffer.push(n),this.sendStop||this.sendSchedule()},t.prototype.sendScheduleWait=function(){var n=this,i;this.sendStop=function(){n.sendStop=null,clearTimeout(i)},i=setTimeout(function(){n.sendStop=null,n.sendSchedule()},25)},t.prototype.sendSchedule=function(){r("sendSchedule",this.sendBuffer.length);var n=this;if(this.sendBuffer.length>0){var i="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,i,function(o){n.sendStop=null,o?(n.emit("close",o.code||1006,"Sending error: "+o),n.close()):n.sendScheduleWait()}),this.sendBuffer=[]}},t.prototype._cleanup=function(){this.removeAllListeners()},t.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},oe=t,oe}var se,ht;function Rr(){if(ht)return se;ht=1;var s=O(),e=P().EventEmitter,r=function(){};function t(n,i,o){e.call(this),this.Receiver=n,this.receiveUrl=i,this.AjaxObject=o,this._scheduleReceiver()}return s(t,e),t.prototype._scheduleReceiver=function(){var n=this,i=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);i.on("message",function(o){n.emit("message",o)}),i.once("close",function(o,a){r("close",o,a,n.pollIsClosing),n.poll=i=null,n.pollIsClosing||(a==="network"?n._scheduleReceiver():(n.emit("close",o||1006,a),n.removeAllListeners()))})},t.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},se=t,se}var ae,dt;function cr(){if(dt)return ae;dt=1;var s=O(),e=k(),r=Sr(),t=Rr();function n(i,o,a,l,h){var u=e.addPath(i,o),d=this;r.call(this,i,a),this.poll=new t(l,u,h),this.poll.on("message",function(m){d.emit("message",m)}),this.poll.once("close",function(m,_){d.poll=null,d.emit("close",m,_),d.close()})}return s(n,r),n.prototype.close=function(){r.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},ae=n,ae}var ue,pt;function D(){if(pt)return ue;pt=1;var s=O(),e=k(),r=cr();function t(i){return function(o,a,l){var h={};typeof a=="string"&&(h.headers={"Content-type":"text/plain"});var u=e.addPath(o,"/xhr_send"),d=new i("POST",u,a,h);return d.once("finish",function(m){if(d=null,m!==200&&m!==204)return l(new Error("http status "+m));l()}),function(){d.close(),d=null;var m=new Error("Aborted");m.code=1e3,l(m)}}}function n(i,o,a,l){r.call(this,i,o,t(l),a,l)}return s(n,r),ue=n,ue}var ce,vt;function z(){if(vt)return ce;vt=1;var s=O(),e=P().EventEmitter;function r(t,n){e.call(this);var i=this;this.bufferPosition=0,this.xo=new n("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(o,a){i._chunkHandler(o,a),i.xo=null;var l=o===200?"network":"permanent";i.emit("close",null,l),i._cleanup()})}return s(r,e),r.prototype._chunkHandler=function(t,n){if(!(t!==200||!n))for(var i=-1;;this.bufferPosition+=i+1){var o=n.slice(this.bufferPosition);if(i=o.indexOf(`
`),i===-1)break;var a=o.slice(0,i);a&&this.emit("message",a)}},r.prototype._cleanup=function(){this.removeAllListeners()},r.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},ce=r,ce}var le,mt;function lr(){if(mt)return le;mt=1;var s=P().EventEmitter,e=O(),r=U(),t=k(),n=y.XMLHttpRequest,i=function(){};function o(h,u,d,m){var _=this;s.call(this),setTimeout(function(){_._start(h,u,d,m)},0)}e(o,s),o.prototype._start=function(h,u,d,m){var _=this;try{this.xhr=new n}catch{}if(!this.xhr){this.emit("finish",0,"no xhr support"),this._cleanup();return}u=t.addQuery(u,"t="+ +new Date),this.unloadRef=r.unloadAdd(function(){_._cleanup(!0)});try{this.xhr.open(h,u,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){i("xhr timeout"),_.emit("finish",0,""),_._cleanup(!1)})}catch{this.emit("finish",0,""),this._cleanup(!1);return}if((!m||!m.noCredentials)&&o.supportsCORS&&(this.xhr.withCredentials=!0),m&&m.headers)for(var I in m.headers)this.xhr.setRequestHeader(I,m.headers[I]);this.xhr.onreadystatechange=function(){if(_.xhr){var R=_.xhr,q,j;switch(i("readyState",R.readyState),R.readyState){case 3:try{j=R.status,q=R.responseText}catch{}j===1223&&(j=204),j===200&&q&&q.length>0&&_.emit("chunk",j,q);break;case 4:j=R.status,j===1223&&(j=204),(j===12005||j===12029)&&(j=0),i("finish",j,R.responseText),_.emit("finish",j,R.responseText),_._cleanup(!1);break}}};try{_.xhr.send(d)}catch{_.emit("finish",0,""),_._cleanup(!1)}},o.prototype._cleanup=function(h){if(this.xhr){if(this.removeAllListeners(),r.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),h)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},o.prototype.close=function(){this._cleanup(!0)},o.enabled=!!n;var a=["Active"].concat("Object").join("X");!o.enabled&&a in y&&(n=function(){try{return new y[a]("Microsoft.XMLHTTP")}catch{return null}},o.enabled=!!new n);var l=!1;try{l="withCredentials"in new n}catch{}return o.supportsCORS=l,le=o,le}var fe,gt;function V(){if(gt)return fe;gt=1;var s=O(),e=lr();function r(t,n,i,o){e.call(this,t,n,i,o)}return s(r,e),r.enabled=e.enabled&&e.supportsCORS,fe=r,fe}var he,yt;function W(){if(yt)return he;yt=1;var s=O(),e=lr();function r(t,n,i){e.call(this,t,n,i,{noCredentials:!0})}return s(r,e),r.enabled=e.enabled,he=r,he}var de,bt;function J(){return bt||(bt=1,de={isOpera:function(){return y.navigator&&/opera/i.test(y.navigator.userAgent)},isKonqueror:function(){return y.navigator&&/konqueror/i.test(y.navigator.userAgent)},hasDomain:function(){if(!y.document)return!0;try{return!!y.document.domain}catch{return!1}}}),de}var pe,wt;function qr(){if(wt)return pe;wt=1;var s=O(),e=D(),r=z(),t=V(),n=W(),i=J();function o(a){if(!n.enabled&&!t.enabled)throw new Error("Transport created when disabled");e.call(this,a,"/xhr_streaming",r,t)}return s(o,e),o.enabled=function(a){return a.nullOrigin||i.isOpera()?!1:t.enabled},o.transportName="xhr-streaming",o.roundTrips=2,o.needBody=!!y.document,pe=o,pe}var ve,Et;function Ve(){if(Et)return ve;Et=1;var s=P().EventEmitter,e=O(),r=U(),t=J(),n=k(),i=function(){};function o(a,l,h){var u=this;s.call(this),setTimeout(function(){u._start(a,l,h)},0)}return e(o,s),o.prototype._start=function(a,l,h){var u=this,d=new y.XDomainRequest;l=n.addQuery(l,"t="+ +new Date),d.onerror=function(){u._error()},d.ontimeout=function(){u._error()},d.onprogress=function(){i("progress",d.responseText),u.emit("chunk",200,d.responseText)},d.onload=function(){u.emit("finish",200,d.responseText),u._cleanup(!1)},this.xdr=d,this.unloadRef=r.unloadAdd(function(){u._cleanup(!0)});try{this.xdr.open(a,l),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(h)}catch{this._error()}},o.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},o.prototype._cleanup=function(a){if(this.xdr){if(this.removeAllListeners(),r.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,a)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},o.prototype.close=function(){this._cleanup(!0)},o.enabled=!!(y.XDomainRequest&&t.hasDomain()),ve=o,ve}var me,xt;function fr(){if(xt)return me;xt=1;var s=O(),e=D(),r=z(),t=Ve();function n(i){if(!t.enabled)throw new Error("Transport created when disabled");e.call(this,i,"/xhr_streaming",r,t)}return s(n,e),n.enabled=function(i){return i.cookie_needed||i.nullOrigin?!1:t.enabled&&i.sameScheme},n.transportName="xdr-streaming",n.roundTrips=2,me=n,me}var ge,_t;function hr(){return _t||(_t=1,ge=y.EventSource),ge}var ye,St;function Tr(){if(St)return ye;St=1;var s=O(),e=P().EventEmitter,r=hr(),t=function(){};function n(i){e.call(this);var o=this,a=this.es=new r(i);a.onmessage=function(l){t("message",l.data),o.emit("message",decodeURI(l.data))},a.onerror=function(l){t("error",a.readyState);var h=a.readyState!==2?"network":"permanent";o._cleanup(),o._close(h)}}return s(n,e),n.prototype.abort=function(){this._cleanup(),this._close("user")},n.prototype._cleanup=function(){var i=this.es;i&&(i.onmessage=i.onerror=null,i.close(),this.es=null)},n.prototype._close=function(i){var o=this;setTimeout(function(){o.emit("close",null,i),o.removeAllListeners()},200)},ye=n,ye}var be,Rt;function qt(){if(Rt)return be;Rt=1;var s=O(),e=D(),r=Tr(),t=V(),n=hr();function i(o){if(!i.enabled())throw new Error("Transport created when disabled");e.call(this,o,"/eventsource",r,t)}return s(i,e),i.enabled=function(){return!!n},i.transportName="eventsource",i.roundTrips=2,be=i,be}var we,Tt;function dr(){return Tt||(Tt=1,we="1.6.1"),we}var Ee={exports:{}},Ot;function H(){return Ot||(Ot=1,function(s){var e=U(),r=J();s.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){s.exports.WPrefix in y||(y[s.exports.WPrefix]={})},postMessage:function(t,n){y.parent!==y&&y.parent.postMessage(JSON.stringify({windowId:s.exports.currentWindowId,type:t,data:n||""}),"*")},createIframe:function(t,n){var i=y.document.createElement("iframe"),o,a,l=function(){clearTimeout(o);try{i.onload=null}catch{}i.onerror=null},h=function(){i&&(l(),setTimeout(function(){i&&i.parentNode.removeChild(i),i=null},0),e.unloadDel(a))},u=function(m){i&&(h(),n(m))},d=function(m,_){setTimeout(function(){try{i&&i.contentWindow&&i.contentWindow.postMessage(m,_)}catch{}},0)};return i.src=t,i.style.display="none",i.style.position="absolute",i.onerror=function(){u("onerror")},i.onload=function(){clearTimeout(o),o=setTimeout(function(){u("onload timeout")},2e3)},y.document.body.appendChild(i),o=setTimeout(function(){u("timeout")},15e3),a=e.unloadAdd(h),{post:d,cleanup:h,loaded:l}},createHtmlfile:function(t,n){var i=["Active"].concat("Object").join("X"),o=new y[i]("htmlfile"),a,l,h,u=function(){clearTimeout(a),h.onerror=null},d=function(){o&&(u(),e.unloadDel(l),h.parentNode.removeChild(h),h=o=null,CollectGarbage())},m=function(R){o&&(d(),n(R))},_=function(R,q){try{setTimeout(function(){h&&h.contentWindow&&h.contentWindow.postMessage(R,q)},0)}catch{}};o.open(),o.write('<html><script>document.domain="'+y.document.domain+'";<\/script></html>'),o.close(),o.parentWindow[s.exports.WPrefix]=y[s.exports.WPrefix];var I=o.createElement("div");return o.body.appendChild(I),h=o.createElement("iframe"),I.appendChild(h),h.src=t,h.onerror=function(){m("onerror")},a=setTimeout(function(){m("timeout")},15e3),l=e.unloadAdd(d),{post:_,cleanup:d,loaded:u}}},s.exports.iframeEnabled=!1,y.document&&(s.exports.iframeEnabled=(typeof y.postMessage=="function"||typeof y.postMessage=="object")&&!r.isKonqueror())}(Ee)),Ee.exports}var xe,It;function pr(){if(It)return xe;It=1;var s=O(),e=P().EventEmitter,r=dr(),t=k(),n=H(),i=U(),o=M(),a=function(){};function l(h,u,d){if(!l.enabled())throw new Error("Transport created when disabled");e.call(this);var m=this;this.origin=t.getOrigin(d),this.baseUrl=d,this.transUrl=u,this.transport=h,this.windowId=o.string(8);var _=t.addPath(d,"/iframe.html")+"#"+this.windowId;this.iframeObj=n.createIframe(_,function(I){m.emit("close",1006,"Unable to load an iframe ("+I+")"),m.close()}),this.onmessageCallback=this._message.bind(this),i.attachEvent("message",this.onmessageCallback)}return s(l,e),l.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){i.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},l.prototype._message=function(h){if(a("message",h.data),!t.isOriginEqual(h.origin,this.origin)){a("not same origin",h.origin,this.origin);return}var u;try{u=JSON.parse(h.data)}catch{a("bad json",h.data);return}if(u.windowId!==this.windowId){a("mismatched window id",u.windowId,this.windowId);return}switch(u.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([r,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",u.data);break;case"c":var d;try{d=JSON.parse(u.data)}catch{a("bad json",u.data);return}this.emit("close",d[0],d[1]),this.close();break}},l.prototype.postMessage=function(h,u){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:h,data:u||""}),this.origin)},l.prototype.send=function(h){this.postMessage("m",h)},l.enabled=function(){return n.iframeEnabled},l.transportName="iframe",l.roundTrips=2,xe=l,xe}var _e,jt;function Ze(){return jt||(jt=1,_e={isObject:function(s){var e=typeof s;return e==="function"||e==="object"&&!!s},extend:function(s){if(!this.isObject(s))return s;for(var e,r,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s}}),_e}var Se,Ct;function Re(){if(Ct)return Se;Ct=1;var s=O(),e=pr(),r=Ze();return Se=function(t){function n(i,o){e.call(this,t.transportName,i,o)}return s(n,e),n.enabled=function(i,o){if(!y.document)return!1;var a=r.extend({},o);return a.sameOrigin=!0,t.enabled(a)&&e.enabled()},n.transportName="iframe-"+t.transportName,n.needBody=!0,n.roundTrips=e.roundTrips+t.roundTrips-1,n.facadeTransport=t,n},Se}var qe,At;function Or(){if(At)return qe;At=1;var s=O(),e=H(),r=k(),t=P().EventEmitter,n=M(),i=function(){};function o(l){t.call(this);var h=this;e.polluteGlobalNamespace(),this.id="a"+n.string(6),l=r.addQuery(l,"c="+decodeURIComponent(e.WPrefix+"."+this.id)),i("using htmlfile",o.htmlfileEnabled);var u=o.htmlfileEnabled?e.createHtmlfile:e.createIframe;y[e.WPrefix][this.id]={start:function(){h.iframeObj.loaded()},message:function(d){h.emit("message",d)},stop:function(){h._cleanup(),h._close("network")}},this.iframeObj=u(l,function(){h._cleanup(),h._close("permanent")})}s(o,t),o.prototype.abort=function(){this._cleanup(),this._close("user")},o.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete y[e.WPrefix][this.id]},o.prototype._close=function(l){this.emit("close",null,l),this.removeAllListeners()},o.htmlfileEnabled=!1;var a=["Active"].concat("Object").join("X");if(a in y)try{o.htmlfileEnabled=!!new y[a]("htmlfile")}catch{}return o.enabled=o.htmlfileEnabled||e.iframeEnabled,qe=o,qe}var Te,Nt;function Pt(){if(Nt)return Te;Nt=1;var s=O(),e=Or(),r=W(),t=D();function n(i){if(!e.enabled)throw new Error("Transport created when disabled");t.call(this,i,"/htmlfile",e,r)}return s(n,t),n.enabled=function(i){return e.enabled&&i.sameOrigin},n.transportName="htmlfile",n.roundTrips=2,Te=n,Te}var Oe,kt;function Lt(){if(kt)return Oe;kt=1;var s=O(),e=D(),r=z(),t=V(),n=W();function i(o){if(!n.enabled&&!t.enabled)throw new Error("Transport created when disabled");e.call(this,o,"/xhr",r,t)}return s(i,e),i.enabled=function(o){return o.nullOrigin?!1:n.enabled&&o.sameOrigin?!0:t.enabled},i.transportName="xhr-polling",i.roundTrips=2,Oe=i,Oe}var Ie,Ut;function Ir(){if(Ut)return Ie;Ut=1;var s=O(),e=D(),r=fr(),t=z(),n=Ve();function i(o){if(!n.enabled)throw new Error("Transport created when disabled");e.call(this,o,"/xhr",t,n)}return s(i,e),i.enabled=r.enabled,i.transportName="xdr-polling",i.roundTrips=2,Ie=i,Ie}var je,Xt;function jr(){if(Xt)return je;Xt=1;var s=H(),e=M(),r=J(),t=k(),n=O(),i=P().EventEmitter,o=function(){};function a(l){var h=this;i.call(this),s.polluteGlobalNamespace(),this.id="a"+e.string(6);var u=t.addQuery(l,"c="+encodeURIComponent(s.WPrefix+"."+this.id));y[s.WPrefix][this.id]=this._callback.bind(this),this._createScript(u),this.timeoutId=setTimeout(function(){h._abort(new Error("JSONP script loaded abnormally (timeout)"))},a.timeout)}return n(a,i),a.prototype.abort=function(){if(y[s.WPrefix][this.id]){var l=new Error("JSONP user aborted read");l.code=1e3,this._abort(l)}},a.timeout=35e3,a.scriptErrorTimeout=1e3,a.prototype._callback=function(l){this._cleanup(),!this.aborting&&(l&&this.emit("message",l),this.emit("close",null,"network"),this.removeAllListeners())},a.prototype._abort=function(l){this._cleanup(),this.aborting=!0,this.emit("close",l.code,l.message),this.removeAllListeners()},a.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var l=this.script;l.parentNode.removeChild(l),l.onreadystatechange=l.onerror=l.onload=l.onclick=null,this.script=null}delete y[s.WPrefix][this.id]},a.prototype._scriptError=function(){var l=this;this.errorTimer||(this.errorTimer=setTimeout(function(){l.loadedOkay||l._abort(new Error("JSONP script loaded abnormally (onerror)"))},a.scriptErrorTimeout))},a.prototype._createScript=function(l){var h=this,u=this.script=y.document.createElement("script"),d;if(u.id="a"+e.string(8),u.src=l,u.type="text/javascript",u.charset="UTF-8",u.onerror=this._scriptError.bind(this),u.onload=function(){h._abort(new Error("JSONP script loaded abnormally (onload)"))},u.onreadystatechange=function(){if(o("onreadystatechange",u.readyState),/loaded|closed/.test(u.readyState)){if(u&&u.htmlFor&&u.onclick){h.loadedOkay=!0;try{u.onclick()}catch{}}u&&h._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof u.async>"u"&&y.document.attachEvent)if(r.isOpera())d=this.script2=y.document.createElement("script"),d.text="try{var a = document.getElementById('"+u.id+"'); if(a)a.onerror();}catch(x){};",u.async=d.async=!1;else{try{u.htmlFor=u.id,u.event="onclick"}catch{}u.async=!0}typeof u.async<"u"&&(u.async=!0);var m=y.document.getElementsByTagName("head")[0];m.insertBefore(u,m.firstChild),d&&m.insertBefore(d,m.firstChild)},je=a,je}var Ce,Bt;function Cr(){if(Bt)return Ce;Bt=1;var s=M(),e=k(),r=function(){},t,n;function i(a){try{return y.document.createElement('<iframe name="'+a+'">')}catch{var l=y.document.createElement("iframe");return l.name=a,l}}function o(){t=y.document.createElement("form"),t.style.display="none",t.style.position="absolute",t.method="POST",t.enctype="application/x-www-form-urlencoded",t.acceptCharset="UTF-8",n=y.document.createElement("textarea"),n.name="d",t.appendChild(n),y.document.body.appendChild(t)}return Ce=function(a,l,h){t||o();var u="a"+s.string(8);t.target=u,t.action=e.addQuery(e.addPath(a,"/jsonp_send"),"i="+u);var d=i(u);d.id=u,d.style.display="none",t.appendChild(d);try{n.value=l}catch{}t.submit();var m=function(_){d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){d.parentNode.removeChild(d),d=null},500),n.value="",h(_))};return d.onerror=function(){m()},d.onload=function(){m()},d.onreadystatechange=function(_){r("onreadystatechange",u,d.readyState),d.readyState==="complete"&&m()},function(){m(new Error("Aborted"))}},Ce}var Ae,Mt;function Ar(){if(Mt)return Ae;Mt=1;var s=O(),e=cr(),r=jr(),t=Cr();function n(i){if(!n.enabled())throw new Error("Transport created when disabled");e.call(this,i,"/jsonp",t,r)}return s(n,e),n.enabled=function(){return!!y.document},n.transportName="jsonp-polling",n.roundTrips=1,n.needBody=!0,Ae=n,Ae}var Ne,Dt;function Nr(){return Dt||(Dt=1,Ne=[_r(),qr(),fr(),qt(),Re()(qt()),Pt(),Re()(Pt()),Lt(),Ir(),Re()(Lt()),Ar()]),Ne}var Wt={},Jt;function Pr(){if(Jt)return Wt;Jt=1;var s=Array.prototype,e=Object.prototype,r=Function.prototype,t=String.prototype,n=s.slice,i=e.toString,o=function(g){return e.toString.call(g)==="[object Function]"},a=function(f){return i.call(f)==="[object Array]"},l=function(f){return i.call(f)==="[object String]"},h=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}(),u;h?u=function(g,f,w,S){!S&&f in g||Object.defineProperty(g,f,{configurable:!0,enumerable:!1,writable:!0,value:w})}:u=function(g,f,w,S){!S&&f in g||(g[f]=w)};var d=function(g,f,w){for(var S in f)e.hasOwnProperty.call(f,S)&&u(g,S,f[S],w)},m=function(g){if(g==null)throw new TypeError("can't convert "+g+" to object");return Object(g)};function _(g){var f=+g;return f!==f?f=0:f!==0&&f!==1/0&&f!==-1/0&&(f=(f>0||-1)*Math.floor(Math.abs(f))),f}function I(g){return g>>>0}function R(){}d(r,{bind:function(f){var w=this;if(!o(w))throw new TypeError("Function.prototype.bind called on incompatible "+w);for(var S=n.call(arguments,1),T=function(){if(this instanceof N){var X=w.apply(this,S.concat(n.call(arguments)));return Object(X)===X?X:this}else return w.apply(f,S.concat(n.call(arguments)))},A=Math.max(0,w.length-S.length),E=[],L=0;L<A;L++)E.push("$"+L);var N=Function("binder","return function ("+E.join(",")+"){ return binder.apply(this, arguments); }")(T);return w.prototype&&(R.prototype=w.prototype,N.prototype=new R,R.prototype=null),N}}),d(Array,{isArray:a});var q=Object("a"),j=q[0]!=="a"||!(0 in q),p=function(f){var w=!0,S=!0;return f&&(f.call("foo",function(T,A,E){typeof E!="object"&&(w=!1)}),f.call([1],function(){S=typeof this=="string"},"x")),!!f&&w&&S};d(s,{forEach:function(f){var w=m(this),S=j&&l(this)?this.split(""):w,T=arguments[1],A=-1,E=S.length>>>0;if(!o(f))throw new TypeError;for(;++A<E;)A in S&&f.call(T,S[A],A,w)}},!p(s.forEach));var b=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;d(s,{indexOf:function(f){var w=j&&l(this)?this.split(""):m(this),S=w.length>>>0;if(!S)return-1;var T=0;for(arguments.length>1&&(T=_(arguments[1])),T=T>=0?T:Math.max(0,S+T);T<S;T++)if(T in w&&w[T]===f)return T;return-1}},b);var c=t.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?function(){var g=/()??/.exec("")[1]===void 0;t.split=function(f,w){var S=this;if(f===void 0&&w===0)return[];if(i.call(f)!=="[object RegExp]")return c.call(this,f,w);var T=[],A=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.extended?"x":"")+(f.sticky?"y":""),E=0,L,N,X,Ye;for(f=new RegExp(f.source,A+"g"),S+="",g||(L=new RegExp("^"+f.source+"$(?!\\s)",A)),w=w===void 0?-1>>>0:I(w);(N=f.exec(S))&&(X=N.index+N[0].length,!(X>E&&(T.push(S.slice(E,N.index)),!g&&N.length>1&&N[0].replace(L,function(){for(var $=1;$<arguments.length-2;$++)arguments[$]===void 0&&(N[$]=void 0)}),N.length>1&&N.index<S.length&&s.push.apply(T,N.slice(1)),Ye=N[0].length,E=X,T.length>=w)));)f.lastIndex===N.index&&f.lastIndex++;return E===S.length?(Ye||!f.test(""))&&T.push(""):T.push(S.slice(E)),T.length>w?T.slice(0,w):T}}():"0".split(void 0,0).length&&(t.split=function(f,w){return f===void 0&&w===0?[]:c.call(this,f,w)});var v=t.substr,x="".substr&&"0b".substr(-1)!=="b";return d(t,{substr:function(f,w){return v.call(this,f<0&&(f=this.length+f)<0?0:f,w)}},x),Wt}var Pe,Ht;function kr(){if(Ht)return Pe;Ht=1;var s=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,e,r=function(t){var n,i={},o=[];for(n=0;n<65536;n++)o.push(String.fromCharCode(n));return t.lastIndex=0,o.join("").replace(t,function(a){return i[a]="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,i};return Pe={quote:function(t){var n=JSON.stringify(t);return s.lastIndex=0,s.test(n)?(e||(e=r(s)),n.replace(s,function(i){return e[i]})):n}},Pe}var ke,$t;function Lr(){if($t)return ke;$t=1;var s=function(){};return ke=function(e){return{filterToEnabled:function(r,t){var n={main:[],facade:[]};return r?typeof r=="string"&&(r=[r]):r=[],e.forEach(function(i){if(i&&!(i.transportName==="websocket"&&t.websocket===!1)){if(r.length&&r.indexOf(i.transportName)===-1){s("not in whitelist",i.transportName);return}i.enabled(t)?(s("enabled",i.transportName),n.main.push(i),i.facadeTransport&&n.facade.push(i.facadeTransport)):s("disabled",i.transportName)}}),n}}},ke}var Le,Ft;function Ur(){if(Ft)return Le;Ft=1;var s={};return["log","debug","warn"].forEach(function(e){var r;try{r=y.console&&y.console[e]&&y.console[e].apply}catch{}s[e]=r?function(){return y.console[e].apply(y.console,arguments)}:e==="log"?function(){}:s.log}),Le=s,Le}var Ue,Gt;function Ke(){if(Gt)return Ue;Gt=1;function s(e){this.type=e}return s.prototype.initEvent=function(e,r,t){return this.type=e,this.bubbles=r,this.cancelable=t,this.timeStamp=+new Date,this},s.prototype.stopPropagation=function(){},s.prototype.preventDefault=function(){},s.CAPTURING_PHASE=1,s.AT_TARGET=2,s.BUBBLING_PHASE=3,Ue=s,Ue}var Xe,Qt;function vr(){return Qt||(Qt=1,Xe=y.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}),Xe}var Be,zt;function Xr(){if(zt)return Be;zt=1;var s=O(),e=Ke();function r(){e.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}return s(r,e),Be=r,Be}var Me,Vt;function Br(){if(Vt)return Me;Vt=1;var s=O(),e=Ke();function r(t){e.call(this),this.initEvent("message",!1,!1),this.data=t}return s(r,e),Me=r,Me}var De,Zt;function Mr(){if(Zt)return De;Zt=1;var s=P().EventEmitter,e=O();function r(){var t=this;s.call(this),this.to=setTimeout(function(){t.emit("finish",200,"{}")},r.timeout)}return e(r,s),r.prototype.close=function(){clearTimeout(this.to)},r.timeout=2e3,De=r,De}var We,Kt;function mr(){if(Kt)return We;Kt=1;var s=P().EventEmitter,e=O(),r=Ze();function t(n,i){s.call(this);var o=this,a=+new Date;this.xo=new i("GET",n),this.xo.once("finish",function(l,h){var u,d;if(l===200){if(d=+new Date-a,h)try{u=JSON.parse(h)}catch{}r.isObject(u)||(u={})}o.emit("finish",u,d),o.removeAllListeners()})}return e(t,s),t.prototype.close=function(){this.removeAllListeners(),this.xo.close()},We=t,We}var Je,Yt;function gr(){if(Yt)return Je;Yt=1;var s=O(),e=P().EventEmitter,r=W(),t=mr();function n(i){var o=this;e.call(this),this.ir=new t(i,r),this.ir.once("finish",function(a,l){o.ir=null,o.emit("message",JSON.stringify([a,l]))})}return s(n,e),n.transportName="iframe-info-receiver",n.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},Je=n,Je}var He,er;function Dr(){if(er)return He;er=1;var s=P().EventEmitter,e=O(),r=U(),t=pr(),n=gr();function i(o,a){var l=this;s.call(this);var h=function(){var u=l.ifr=new t(n.transportName,a,o);u.once("message",function(d){if(d){var m;try{m=JSON.parse(d)}catch{l.emit("finish"),l.close();return}var _=m[0],I=m[1];l.emit("finish",_,I)}l.close()}),u.once("close",function(){l.emit("finish"),l.close()})};y.document.body?h():r.attachEvent("load",h)}return e(i,s),i.enabled=function(){return t.enabled()},i.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},He=i,He}var $e,tr;function Wr(){if(tr)return $e;tr=1;var s=P().EventEmitter,e=O(),r=k(),t=Ve(),n=V(),i=W(),o=Mr(),a=Dr(),l=mr();function h(u,d){var m=this;s.call(this),setTimeout(function(){m.doXhr(u,d)},0)}return e(h,s),h._getReceiver=function(u,d,m){return m.sameOrigin?new l(d,i):n.enabled?new l(d,n):t.enabled&&m.sameScheme?new l(d,t):a.enabled()?new a(u,d):new l(d,o)},h.prototype.doXhr=function(u,d){var m=this,_=r.addPath(u,"/info");this.xo=h._getReceiver(u,_,d),this.timeoutRef=setTimeout(function(){m._cleanup(!1),m.emit("finish")},h.timeout),this.xo.once("finish",function(I,R){m._cleanup(!0),m.emit("finish",I,R)})},h.prototype._cleanup=function(u){clearTimeout(this.timeoutRef),this.timeoutRef=null,!u&&this.xo&&this.xo.close(),this.xo=null},h.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},h.timeout=8e3,$e=h,$e}var Fe,rr;function Jr(){if(rr)return Fe;rr=1;var s=H();function e(r){this._transport=r,r.on("message",this._transportMessage.bind(this)),r.on("close",this._transportClose.bind(this))}return e.prototype._transportClose=function(r,t){s.postMessage("c",JSON.stringify([r,t]))},e.prototype._transportMessage=function(r){s.postMessage("t",r)},e.prototype._send=function(r){this._transport.send(r)},e.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},Fe=e,Fe}var Ge,nr;function Hr(){if(nr)return Ge;nr=1;var s=k(),e=U(),r=Jr(),t=gr(),n=H(),i=vr(),o=function(){};return Ge=function(a,l){var h={};l.forEach(function(d){d.facadeTransport&&(h[d.facadeTransport.transportName]=d.facadeTransport)}),h[t.transportName]=t;var u;a.bootstrap_iframe=function(){var d;n.currentWindowId=i.hash.slice(1);var m=function(_){if(_.source===parent&&(typeof u>"u"&&(u=_.origin),_.origin===u)){var I;try{I=JSON.parse(_.data)}catch{o("bad json",_.data);return}if(I.windowId===n.currentWindowId)switch(I.type){case"s":var R;try{R=JSON.parse(I.data)}catch{o("bad json",I.data);break}var q=R[0],j=R[1],p=R[2],b=R[3];if(q!==a.version)throw new Error('Incompatible SockJS! Main site uses: "'+q+'", the iframe: "'+a.version+'".');if(!s.isOriginEqual(p,i.href)||!s.isOriginEqual(b,i.href))throw new Error("Can't connect to different domain from within an iframe. ("+i.href+", "+p+", "+b+")");d=new r(new h[j](p,b));break;case"m":d._send(I.data);break;case"c":d&&d._close(),d=null;break}}};e.attachEvent("message",m),n.postMessage("s")}},Ge}var Qe,ir;function $r(){if(ir)return Qe;ir=1,Pr();var s=ar(),e=O(),r=M(),t=kr(),n=k(),i=U(),o=Lr(),a=Ze(),l=J(),h=Ur(),u=Ke(),d=ur(),m=vr(),_=Xr(),I=Br(),R=Wr(),q=function(){},j;function p(c,v,x){if(!(this instanceof p))return new p(c,v,x);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");d.call(this),this.readyState=p.CONNECTING,this.extensions="",this.protocol="",x=x||{},x.protocols_whitelist&&h.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=x.transports,this._transportOptions=x.transportOptions||{},this._timeout=x.timeout||0;var g=x.sessionId||8;if(typeof g=="function")this._generateSessionId=g;else if(typeof g=="number")this._generateSessionId=function(){return r.string(g)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=x.server||r.numberString(1e3);var f=new s(c);if(!f.host||!f.protocol)throw new SyntaxError("The URL '"+c+"' is invalid");if(f.hash)throw new SyntaxError("The URL must not contain a fragment");if(f.protocol!=="http:"&&f.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+f.protocol+"' is not allowed.");var w=f.protocol==="https:";if(m.protocol==="https:"&&!w&&!n.isLoopbackAddr(f.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");v?Array.isArray(v)||(v=[v]):v=[];var S=v.sort();S.forEach(function(A,E){if(!A)throw new SyntaxError("The protocols entry '"+A+"' is invalid.");if(E<S.length-1&&A===S[E+1])throw new SyntaxError("The protocols entry '"+A+"' is duplicated.")});var T=n.getOrigin(m.href);this._origin=T?T.toLowerCase():null,f.set("pathname",f.pathname.replace(/\/+$/,"")),this.url=f.href,q("using url",this.url),this._urlInfo={nullOrigin:!l.hasDomain(),sameOrigin:n.isOriginEqual(this.url,m.href),sameScheme:n.isSchemeEqual(this.url,m.href)},this._ir=new R(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}e(p,d);function b(c){return c===1e3||c>=3e3&&c<=4999}return p.prototype.close=function(c,v){if(c&&!b(c))throw new Error("InvalidAccessError: Invalid code");if(v&&v.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===p.CLOSING||this.readyState===p.CLOSED)){var x=!0;this._close(c||1e3,v||"Normal closure",x)}},p.prototype.send=function(c){if(typeof c!="string"&&(c=""+c),this.readyState===p.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===p.OPEN&&this._transport.send(t.quote(c))},p.version=dr(),p.CONNECTING=0,p.OPEN=1,p.CLOSING=2,p.CLOSED=3,p.prototype._receiveInfo=function(c,v){if(this._ir=null,!c){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(v),this._transUrl=c.base_url?c.base_url:this.url,c=a.extend(c,this._urlInfo);var x=j.filterToEnabled(this._transportsWhitelist,c);this._transports=x.main,q(this._transports.length+" enabled transports"),this._connect()},p.prototype._connect=function(){for(var c=this._transports.shift();c;c=this._transports.shift()){if(q("attempt",c.transportName),c.needBody&&(!y.document.body||typeof y.document.readyState<"u"&&y.document.readyState!=="complete"&&y.document.readyState!=="interactive")){this._transports.unshift(c),i.attachEvent("load",this._connect.bind(this));return}var v=Math.max(this._timeout,this._rto*c.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),v);var x=n.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),g=this._transportOptions[c.transportName],f=new c(x,this._transUrl,g);f.on("message",this._transportMessage.bind(this)),f.once("close",this._transportClose.bind(this)),f.transportName=c.transportName,this._transport=f;return}this._close(2e3,"All transports failed",!1)},p.prototype._transportTimeout=function(){this.readyState===p.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},p.prototype._transportMessage=function(c){var v=this,x=c.slice(0,1),g=c.slice(1),f;switch(x){case"o":this._open();return;case"h":this.dispatchEvent(new u("heartbeat")),q("heartbeat",this.transport);return}if(g)try{f=JSON.parse(g)}catch{}if(!(typeof f>"u"))switch(x){case"a":Array.isArray(f)&&f.forEach(function(w){q("message",v.transport),v.dispatchEvent(new I(w))});break;case"m":q("message",this.transport),this.dispatchEvent(new I(f));break;case"c":Array.isArray(f)&&f.length===2&&this._close(f[0],f[1],!0);break}},p.prototype._transportClose=function(c,v){if(q("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!b(c)&&c!==2e3&&this.readyState===p.CONNECTING){this._connect();return}this._close(c,v)},p.prototype._open=function(){q("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===p.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=p.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new u("open")),q("connected",this.transport)):this._close(1006,"Server lost session")},p.prototype._close=function(c,v,x){q("_close",this.transport,c,v,x,this.readyState);var g=!1;if(this._ir&&(g=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===p.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=p.CLOSING,setTimeout((function(){this.readyState=p.CLOSED,g&&this.dispatchEvent(new u("error"));var f=new _("close");f.wasClean=x||!1,f.code=c||1e3,f.reason=v,this.dispatchEvent(f),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)},p.prototype.countRTO=function(c){return c>100?4*c:300+c},Qe=function(c){return j=o(c),Hr()(p,c),p},Qe}var ze,or;function Fr(){if(or)return ze;or=1;var s=Nr();return ze=$r()(s),"_sockjs_onload"in y&&setTimeout(y._sockjs_onload,1),ze}Fr();function Gr(s){const e="=".repeat((4-s.length%4)%4),r=(s+e).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(r),n=new Uint8Array(t.length);for(let i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function Qr({userId:s}){const[e,r]=B.useState([]),[t,n]=B.useState(null),[i,o]=B.useState(!1),[a,l]=B.useState("테스트 제목"),[h,u]=B.useState("이것은 백엔드에서 보낸 푸시 알림입니다!"),[d,m]=B.useState(!1),_="BDgnhdO6oZ0uD0vA9YlsOi_1FcMkxUUXOqbBQrscEctZGpvIszTkuQk99LR06fkQvejdwlbYvlDSoaEwvg91bwI",I=async()=>{if(console.log("🔥 subscribeToPush 함수 시작!"),console.log("현재 알림 권한:",Notification.permission),Notification.permission!=="granted"){console.log("알림 권한 요청 중...");const q=await Notification.requestPermission();if(console.log("알림 권한 요청 결과:",q),q!=="granted"){alert("알림 권한이 거부되었습니다.");return}}try{console.log("서비스 워커 준비 상태 확인 중...");const q=await navigator.serviceWorker.ready;console.log("서비스 워커 준비 완료:",q),console.log("푸시 구독 시작...");const j=await q.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Gr(_)});console.log("✅ 푸시 구독 성공:",j),console.log("구독 정보 상세:",JSON.stringify(j,null,2)),console.log("백엔드로 구독 정보 전송 중...");const p=await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});console.log("백엔드 응답 상태:",p.status),console.log("백엔드 응답:",await p.text()),alert("푸시 알림 구독이 완료되었습니다!"),m(!0)}catch(q){console.error("❌ 푸시 구독 실패:",q),console.error("에러 스택:",q.stack),alert("푸시 알림 구독에 실패했습니다. 콘솔을 확인해주세요.")}},R=async()=>{if(!a||!h){alert("제목과 내용을 모두 입력해주세요.");return}console.log(`📨 백엔드로 푸시 알림 요청: 제목=${a}, 내용=${h}`);try{await fetch("/api/send-all",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:a,body:h})}),alert("백엔드로 알림 발송 요청을 보냈습니다.")}catch(q){console.error("❌ 알림 발송 요청 실패:",q),alert("알림 발송 요청에 실패했습니다. 콘솔을 확인해주세요.")}};return C.jsxs("div",{style:{display:"flex",gap:"20px"},children:[C.jsx("div",{className:"notification-container",style:{padding:"20px",border:"1px solid #ddd",width:"50%"},children:C.jsxs("h2",{children:["웹소켓 알림 목록 (사용자: ",s,")"]})}),C.jsxs("div",{className:"push-test-container",style:{padding:"20px",border:"1px solid #28a745",width:"50%"},children:[C.jsx("h2",{children:"🚀 웹 푸시 알림 테스트"}),C.jsx("p",{children:"백그라운드에서도 동작하는 알림을 테스트합니다."}),C.jsxs("div",{style:{marginBottom:"20px"},children:[C.jsx("button",{onClick:I,disabled:d,children:d?"✅ 푸시 구독 완료":"🔔 푸시 알림 구독하기"}),C.jsx("p",{style:{fontSize:"12px",color:"#666"},children:"브라우저에 알림을 받을 수 있도록 등록합니다. (최초 1회)"})]}),C.jsx("hr",{}),C.jsxs("div",{style:{marginTop:"20px"},children:[C.jsx("h3",{children:"백엔드에 알림 발송 요청하기"}),C.jsxs("div",{style:{marginBottom:"10px"},children:[C.jsx("label",{htmlFor:"push-title",style:{display:"block"},children:"제목:"}),C.jsx("input",{id:"push-title",type:"text",value:a,onChange:q=>l(q.target.value),style:{width:"90%",padding:"8px"}})]}),C.jsxs("div",{style:{marginBottom:"10px"},children:[C.jsx("label",{htmlFor:"push-body",style:{display:"block"},children:"내용:"}),C.jsx("textarea",{id:"push-body",value:h,onChange:q=>u(q.target.value),rows:"3",style:{width:"90%",padding:"8px"}})]}),C.jsx("button",{onClick:R,children:"📤 백엔드에 푸시 알림 요청"})]})]})]})}function zr(){return C.jsx(Qr,{userId:"user1234"})}const sr=document.getElementById("root");sr&&yr.createRoot(sr).render(C.jsx(zr,{}));
